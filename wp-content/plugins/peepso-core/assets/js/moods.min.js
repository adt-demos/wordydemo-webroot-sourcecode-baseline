!function n(r,d,a){function p(t,o){if(!d[t]){if(!r[t]){var e="function"==typeof require&&require;if(!o&&e)return e(t,!0);if(h)return h(t,!0);var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}var i=d[t]={exports:{}};r[t][0].call(i.exports,function(o){return p(r[t][1][o]||o)},i,i.exports,n,r,d,a)}return d[t].exports}for(var h="function"==typeof require&&require,o=0;o<a.length;o++)p(a[o]);return p}({1:[function(o,t,e){"use strict";function s(){this.__constructor.apply(this,arguments)}var n,r,i,d,a,p,h,u;function c(){this.$postbox=null,this.$container=null,this.$mood=null,this.$mood_remove=null,this.$mood_dropdown_toggle=null,this.mood_selected=!1,this.can_submit=!1}n=jQuery,i=(r=n)("#mood-text-string").text(),d=!1,a=".ps-postbox-moods",s.prototype={__constructor:function(o){this.postbox=o,this.$container=o.$el.find("#mood-tab"),this.$toggle=this.$container.find(".ps-js-postbox-toggle"),this.$dropdown=this.$container.find(".ps-js-postbox-mood"),this.$remove=this.$dropdown.find("button"),this.$toggle.on("click"+a,r.proxy(this.toggle,this)),this.$dropdown.on("click"+a,".ps-js-mood-item",r.proxy(this.select,this)),this.$remove.on("click"+a,r.proxy(this.remove,this)),this._mapMoods(),o.addAction("update",this.update,10,2,this),o.addFilter("render_addons",this.render,10,1,this),o.addFilter("data",this.filterData,10,1,this),o.addFilter("data_validate",this.validate,10,2,this)},show:function(){var t=this;this.$dropdown.show(),this.$container.addClass("ps-postbox__menu-item--open"),setTimeout(function(){r(document).off("mouseup.ps-postbox-moods").on("mouseup.ps-postbox-moods",function(o){0===t.$container.has(o.target).length&&t.hide()})},1)},hide:function(){this.$dropdown.hide(),this.$container.removeClass("ps-postbox__menu-item--open"),r(document).off("mouseup.ps-postbox-moods")},toggle:function(){this.$dropdown.is(":visible")?this.hide():this.show()},filterData:function(o){return this._selected?o.mood=this._selected.value:o.mood="",o},validate:function(o){return!!this._selected||o},select:function(o){var t=r(o.currentTarget);t.length&&(this._selected={value:t.data("option-value"),label:t.data("option-display-value"),className:t.find("i").attr("class")},this.$toggle.addClass("active"),this.$remove.show(),this.postbox.doAction("refresh"),this.hide())},remove:function(){this._selected=!1,this.$toggle.removeClass("active"),this.$remove.hide(),this.postbox.doAction("refresh"),this.hide()},update:function(o){(o=o&&o.data||{}).mood?(this._selected={value:o.mood,label:d[o.mood].label,className:d[o.mood].icon},this.$toggle.addClass("active"),this.$remove.show()):(this._selected=!1,this.$toggle.removeClass("active"),this.$remove.hide()),this.postbox.doAction("refresh")},render:function(o){var t;return this._selected&&(t='<i class="'+this._selected.className+'"></i>',t+="<b> "+i+this._selected.label+"</b>",o.push(t)),o},_mapMoods:function(){d||this.$dropdown.find("a.ps-js-mood-item").each(function(){var o=r(this),t=o.find("i"),e=o.data("option-value"),s=o.data("option-display-value"),i=t.attr("class");(d=d||{})[e]={icon:i,label:s}})}},p=s,peepso.observer.addAction("postbox_init",function(o){new p(o)},10,1),peepso.observer.addFilter("human_friendly_extras",function(o,t,e){var s,i;return t||!e||(s=n(e).find(".ps-js-activity-extras .ps-post__mood")).length&&(i=function(o){o=o.split(" ");for(var t=0;t<o.length;t++)o[t]=o[t][0].toUpperCase()+o[t].slice(1);return o.join(" ")}(s.text().trim()),o.push(i)),o},10,3),jQuery||$,h=peepso,u=h,c.prototype.set_postbox=function(o){this.$postbox=o},c.prototype.init=function(){var s;_.isUndefined(this.$postbox)||(s=this,u.observer.addFilter("peepso_postbox_can_submit",function(o){return o.soft.push(s.can_submit),o},20,1),this.$container=this.$postbox.find("#mood-tab"),this.$mood=jQuery("#postbox-mood",this.$postbox),this.$mood_dropdown_toggle=jQuery("#mood-tab .ps-js-interaction-wrapper > a",this.$postbox),this.$mood_remove=jQuery("#postbox-mood-remove",this.$postbox),this.$mood.on("click","a.ps-js-mood-item",function(o){s.select_mood(o)}),this.$mood_remove.on("click",function(){s.remove_mood()}),this.$mood_dropdown_toggle.on("click",function(){if(s.$mood.is(":visible"))return s.$mood.hide(),s.$container.removeClass("ps-postbox__menu-item--open"),void jQuery(document).off("mouseup.ps-postbox-moods");s.$mood.show(),s.$container.addClass("ps-postbox__menu-item--open"),setTimeout(function(){jQuery(document).off("mouseup.ps-postbox-moods").on("mouseup.ps-postbox-moods",function(o){0===s.$container.has(o.target).length&&(s.$mood.hide(),s.$container.removeClass("ps-postbox__menu-item--open"),jQuery(document).off("mouseup.ps-postbox-moods"))})},1)}),this.$mood_dropdown_toggle.on("peepso.interaction-hide",function(){s.$mood.hide(),s.$container.removeClass("ps-postbox__menu-item--open")}),this.$postbox.on("postbox.post_cancel postbox.post_saved",function(){s.remove_mood()}),u.observer.addFilter("postbox_req_"+this.$postbox.guid,function(o){return s.set_mood(o)},10,1),u.observer.addFilter("peepso_postbox_addons_update",function(o){var t,e;return s.mood_selected&&(e='<i class="ps-emoticon '+(t=s.mood_selected)[0]+'"></i> <b>'+t[1]+"</b>",o.push(e)),o},10,1))},c.prototype.select_mood=function(o){var t=jQuery(o.target).closest("a"),e=jQuery("#mood-tab",this.$postbox),s=jQuery("#postbox-mood-input",this.$postbox),i=(e.find("a"),t.closest("#postbox-mood")),n=(this.$postbox.$textarea.parent(),t.find("i").attr("class")),r=jQuery("#mood-text-string").text()+t.attr("data-option-display-value");s.val(t.attr("data-option-value")),this.$mood_remove.show(),i.hide(),this.$container.addClass("active"),this.$container.removeClass("ps-postbox__menu-item--open"),this.mood_selected=[n,r],this.can_submit=!0,this.$postbox.on_change()},c.prototype.remove_mood=function(){jQuery("span#postmood",this.$postbox.$textarea.parent()).remove(),jQuery("#postbox-mood-input",this.$postbox).val(""),this.$container.removeClass("active"),this.$container.removeClass("ps-postbox__menu-item--open"),this.$mood_remove.hide(),this.$mood.hide(),this.mood_selected=!1,this.can_submit=!1,this.$postbox.on_change()},c.prototype.set_mood=function(o){return void 0===o.mood&&(o.mood=""),o.mood=jQuery("#postbox-mood-input",this.$postbox).val(),o},u.observer.addFilter("peepso_postbox_addons",function(o){return o.push(new c),o},10,1)},{}]},{},[1]);